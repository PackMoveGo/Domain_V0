"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[400],{400:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var o=a(7876),s=a(4232),n=a(6590),i=a(8307),r=a(6517);let l=()=>{let e,t,a,l,c,u=(0,i.Zp)(),d=(0,i.zy)(),[h,p]=(0,s.useState)(!0),[g,m]=(0,s.useState)(!1),[E,v]=(0,s.useState)(!1),[y,f]=(0,s.useState)(!1),C=(0,s.useRef)(0);["/cookie-opt-out","/privacy","/terms"].includes(d.pathname);let w="/cookie-opt-out"===d.pathname,[A,R]=(0,s.useState)(!1),[T,b]=(0,s.useState)(null);try{let o=(0,n.k)();o.preferences,e=o.hasOptedOut,t=o.hasMadeChoice,a=o.optIn,o.optOut,o.updatePreferences,l=o.isLoading,o.isApiBlocked,o.checkBannerTimer,c=o.clearBannerCache}catch(o){console.error("\uD83C\uDF6A CookieOptOut: Error accessing cookie preferences:",o),e=!1,t=!1,l=!1,a=()=>console.warn("Cookie preferences not available"),c=()=>{}}let k=()=>{document.body.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.left="",document.body.style.right="",document.body.style.width="",document.body.style.touchAction="",document.documentElement.style.overflow="",document.documentElement.style.touchAction="",window.scrollTo(0,C.current)};(0,s.useEffect)(()=>{let e=setTimeout(()=>{v(!0)},100);return()=>clearTimeout(e)},[]),(0,s.useEffect)(()=>{if(E&&!l){let e=setTimeout(()=>{R(!0)},200);return()=>clearTimeout(e)}},[E,l]),(0,s.useEffect)(()=>{let e=()=>{console.log("\uD83C\uDF6A Cookie consent reset event received - showing modal"),p(!0),m(!1)};return window.addEventListener("cookie-consent-reset",e),()=>window.removeEventListener("cookie-consent-reset",e)},[]),(0,s.useEffect)(()=>{let e;return h&&!l&&E&&!w?e=(()=>{C.current=window.scrollY,document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top="-".concat(C.current,"px"),document.body.style.left="0",document.body.style.right="0",document.body.style.width="100%",document.documentElement.style.overflow="hidden",document.body.style.touchAction="none",document.documentElement.style.touchAction="none";let e=e=>{e.preventDefault()},t=e=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Space","PageUp","PageDown","Home","End"].includes(e.code)&&e.preventDefault()};return document.addEventListener("wheel",e,{passive:!1}),document.addEventListener("touchmove",e,{passive:!1}),document.addEventListener("keydown",t),()=>{document.removeEventListener("wheel",e),document.removeEventListener("touchmove",e),document.removeEventListener("keydown",t)}})():h||w||k(),()=>{e&&e(),w||k()}},[h,l,E,w]);let S=()=>{console.log("\uD83C\uDF6A CookieOptOut: handleOptIn called"),console.log("\uD83C\uDF6A CookieOptOut: optIn function available:",!!a),console.log("\uD83C\uDF6A CookieOptOut: hasMadeChoice:",t,"hasOptedOut:",e),b("accept"),a?(console.log("\uD83C\uDF6A CookieOptOut: Calling optIn function"),f(!0),a(),w?setTimeout(()=>{console.log("\uD83C\uDF6A CookieOptOut: Navigating to home page after opt-in (full page mode)"),u("/")},500):(m(!0),setTimeout(()=>{p(!1),m(!1),f(!1),console.log("\uD83C\uDF6A CookieOptOut: Waiting for API state to update before navigation..."),setTimeout(()=>{console.log("\uD83C\uDF6A CookieOptOut: Navigating to home page after opt-in"),u("/")},200)},300))):console.warn("\uD83C\uDF6A CookieOptOut: Cookie preferences context not available for opt-in")},I=()=>{b("custom"),localStorage.setItem("packmovego-last-banner-time",(0,r.mI)().toString()),c&&c(),w||u("/cookie-opt-out")},N=()=>{localStorage.setItem("packmovego-last-banner-time",(0,r.mI)().toString()),c&&c(),w?u("/"):(m(!0),setTimeout(()=>{p(!1),m(!1)},300))};return h&&!l&&E?w?(0,o.jsx)("div",{className:"min-h-screen py-8",children:(0,o.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,o.jsxs)("div",{className:"\n            bg-white/95 backdrop-blur-sm rounded-xl shadow-2xl p-6 sm:p-8 lg:p-12 relative\n            transition-all duration-1000 ease-out\n            ".concat(A?"translate-y-0 opacity-100 scale-100":"translate-y-12 opacity-0 scale-95","\n            border border-white/20\n          "),children:[(0,o.jsx)("button",{onClick:()=>{w?u("/"):(m(!0),setTimeout(()=>{p(!1),m(!1)},300))},className:"\n                absolute top-4 right-4 w-8 h-8 sm:w-10 sm:h-10 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 rounded-full flex items-center justify-center transition-all duration-300 z-10 touch-manipulation\n                ".concat(A?"translate-x-0 opacity-100":"translate-x-4 opacity-0","\n              "),style:{transitionDelay:A?"200ms":"0ms"},"aria-label":"Close cookie preferences",children:(0,o.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,o.jsxs)("div",{className:"\n              text-center mb-6 sm:mb-8\n              transition-all duration-1000 ease-out delay-300\n              ".concat(A?"translate-y-0 opacity-100":"translate-y-6 opacity-0","\n            "),children:[(0,o.jsx)("div",{className:"\n                w-16 h-16 sm:w-20 sm:h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4 sm:mb-6\n                transition-all duration-1000 ease-out delay-400\n                ".concat(A?"scale-100 rotate-0":"scale-75 rotate-12","\n              "),children:(0,o.jsx)("svg",{className:"\n                  w-8 h-8 sm:w-10 sm:h-10 text-red-600\n                  transition-all duration-800 ease-out delay-500\n                  ".concat(A?"scale-100":"scale-0","\n                "),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,o.jsx)("h1",{className:"\n                text-2xl sm:text-3xl font-bold text-gray-900 mb-3\n                transition-all duration-800 ease-out delay-600\n                ".concat(A?"translate-y-0 opacity-100":"translate-y-4 opacity-0","\n              "),children:"Cookie Preferences"}),(0,o.jsx)("p",{className:"\n                text-base sm:text-lg text-gray-600\n                transition-all duration-800 ease-out delay-700\n                ".concat(A?"translate-y-0 opacity-100":"translate-y-4 opacity-0","\n              "),children:"Manage your cookie preferences and privacy settings"})]}),(0,o.jsx)("div",{className:"\n          bg-yellow-50 border border-yellow-200 rounded-lg p-4 sm:p-6 mb-4 sm:mb-6\n          transition-all duration-700 ease-out delay-400\n          ".concat(A?"translate-y-0 opacity-100":"translate-y-4 opacity-0","\n        "),children:(0,o.jsxs)("div",{className:"flex items-start",children:[(0,o.jsx)("div",{className:"flex-shrink-0",children:(0,o.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-yellow-600 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,o.jsxs)("div",{className:"ml-3",children:[(0,o.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-yellow-800 mb-2",children:"Third-Party Advertising Cookies"}),(0,o.jsx)("p",{className:"text-sm sm:text-base text-yellow-700 leading-relaxed",children:'This website uses third party advertising cookies to serve you relevant ads. You may opt-out from these third party ad cookies by clicking the "Opt-out" button below. If you have a Pack Move GO account, you may opt-out of the "sale" or "sharing" of your data here.'})]})]})}),(0,o.jsx)("div",{className:"\n          bg-red-50 border border-red-200 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6\n          transition-all duration-700 ease-out delay-500\n          ".concat(A?"translate-y-0 opacity-100":"translate-y-4 opacity-0","\n        "),children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-red-600 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,o.jsx)("span",{className:"text-sm sm:text-base text-red-800 font-medium",children:e?"You are currently opted out of all cookies":"Please make a choice about cookie preferences"})]})}),(0,o.jsxs)("div",{className:"\n          flex flex-col sm:flex-row gap-3 sm:gap-4\n          transition-all duration-700 ease-out delay-600\n          ".concat(A?"translate-y-0 opacity-100":"translate-y-4 opacity-0","\n        "),children:[(0,o.jsxs)("button",{onClick:S,disabled:y,className:"\n              flex-1 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-semibold \n              py-3 sm:py-3 px-4 sm:px-6 rounded-lg transition duration-200 flex items-center justify-center\n              min-h-[48px] touch-manipulation\n              ".concat(y?"opacity-50 cursor-not-allowed":"hover:bg-blue-700 active:bg-blue-800","\n              ").concat("accept"===T?"ring-2 ring-blue-300 ring-offset-2":"","\n            "),children:[(0,o.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,o.jsx)("span",{className:"text-sm sm:text-base",children:y&&"accept"===T?"Opting In...":"Opt In to All Cookies"})]}),(0,o.jsx)("button",{onClick:I,disabled:y,className:"\n              flex-1 bg-gray-200 hover:bg-gray-300 active:bg-gray-400 text-gray-800 font-semibold \n              py-3 sm:py-3 px-4 sm:px-6 rounded-lg transition duration-200 min-h-[48px] touch-manipulation\n              ".concat(y?"opacity-50 cursor-not-allowed":"hover:bg-gray-300 active:bg-gray-400","\n              ").concat("custom"===T?"ring-2 ring-gray-300 ring-offset-2":"","\n            "),children:(0,o.jsx)("span",{className:"text-sm sm:text-base",children:"Manage Preferences"})})]}),t&&!e&&(0,o.jsx)("div",{className:"\n            mt-3 sm:mt-4 text-center\n            transition-all duration-700 ease-out delay-700\n            ".concat(A?"translate-y-0 opacity-100":"translate-y-4 opacity-0","\n          "),children:(0,o.jsx)("button",{onClick:N,disabled:y,className:"\n                text-sm sm:text-base text-gray-500 hover:text-gray-700 active:text-gray-800 underline\n                py-2 px-3 touch-manipulation\n                ".concat(y?"opacity-50 cursor-not-allowed":"hover:text-gray-700 active:text-gray-800","\n              "),children:"Dismiss for 30 minutes"})}),(0,o.jsx)("div",{className:"\n              mt-6 sm:mt-8 pt-4 sm:pt-6 border-t border-gray-200\n              transition-all duration-700 ease-out delay-800\n              ".concat(A?"translate-y-0 opacity-100":"translate-y-4 opacity-0","\n            "),children:(0,o.jsxs)("p",{className:"text-sm sm:text-base text-gray-600 text-center leading-relaxed",children:["By opting in, you agree to our"," ",(0,o.jsx)("a",{href:"/privacy",className:"text-blue-600 hover:text-blue-800 active:text-blue-900 underline touch-manipulation",children:"Privacy Policy"})," ","and"," ",(0,o.jsx)("a",{href:"/terms",className:"text-blue-600 hover:text-blue-800 active:text-blue-900 underline touch-manipulation",children:"Terms of Service"})]})})]})})}):(0,o.jsx)("div",{className:"\n        fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[10001] p-2 sm:p-4\n        transition-all duration-700 ease-[cubic-bezier(0.4,0,0.2,1)]\n        ".concat(g?"opacity-0 backdrop-blur-none":"opacity-100 backdrop-blur-sm","\n        ").concat(E?"":"pointer-events-none","\n      "),style:{touchAction:"none"},children:(0,o.jsxs)("div",{className:"\n        bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl max-w-2xl w-full p-4 sm:p-6 lg:p-8 relative\n        transition-all duration-1000 ease-[cubic-bezier(0.34,1.56,0.64,1)] max-h-[95vh] overflow-y-auto\n        ".concat(g?"scale-90 opacity-0 rotate-2 translate-y-4":"scale-100 opacity-100 rotate-0 translate-y-0","\n        ").concat(A?"translate-y-0":"translate-y-12","\n        border border-white/20\n        hover:shadow-3xl\n      "),children:[(0,o.jsxs)("div",{className:"\n          text-center mb-4 sm:mb-6\n          transition-all duration-1000 ease-[cubic-bezier(0.34,1.56,0.64,1)] delay-200\n          ".concat(A?"translate-y-0 opacity-100":"translate-y-8 opacity-0","\n        "),children:[(0,o.jsx)("div",{className:"\n            w-12 h-12 sm:w-16 sm:h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4\n            transition-all duration-1200 ease-[cubic-bezier(0.68,-0.55,0.265,1.55)] delay-300\n            ".concat(A?"scale-100 rotate-0":"scale-50 rotate-180","\n            hover:scale-110 hover:rotate-12 hover:bg-red-200\n            shadow-lg hover:shadow-xl\n          "),children:(0,o.jsx)("svg",{className:"\n              w-6 h-6 sm:w-8 sm:h-8 text-red-600\n              transition-all duration-800 ease-[cubic-bezier(0.68,-0.55,0.265,1.55)] delay-500\n              ".concat(A?"scale-100 rotate-0":"scale-0 rotate-360","\n            "),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,o.jsx)("h2",{className:"\n            text-xl sm:text-2xl font-bold text-gray-900 mb-2\n            transition-all duration-800 ease-[cubic-bezier(0.34,1.56,0.64,1)] delay-600\n            ".concat(A?"translate-y-0 opacity-100":"translate-y-6 opacity-0","\n            hover:text-red-600\n          "),children:"Cookie Preferences"}),(0,o.jsx)("p",{className:"\n            text-sm sm:text-base text-gray-600\n            transition-all duration-800 ease-[cubic-bezier(0.34,1.56,0.64,1)] delay-700\n            ".concat(A?"translate-y-0 opacity-100":"translate-y-6 opacity-0","\n          "),children:"Manage your cookie preferences and privacy settings"})]}),(0,o.jsx)("div",{className:"\n          bg-yellow-50 border border-yellow-200 rounded-lg p-4 sm:p-6 mb-4 sm:mb-6\n          transition-all duration-1000 ease-[cubic-bezier(0.34,1.56,0.64,1)] delay-800\n          ".concat(A?"translate-y-0 opacity-100 scale-100":"translate-y-8 opacity-0 scale-90","\n          hover:shadow-lg hover:scale-[1.02] hover:bg-yellow-100\n        "),children:(0,o.jsxs)("div",{className:"flex items-start",children:[(0,o.jsx)("div",{className:"\n              flex-shrink-0\n              transition-all duration-800 ease-[cubic-bezier(0.68,-0.55,0.265,1.55)] delay-900\n              ".concat(A?"scale-100 rotate-0":"scale-0 rotate-360","\n            "),children:(0,o.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-yellow-600 mt-0.5 transition-all duration-300 hover:scale-110 hover:text-yellow-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,o.jsxs)("div",{className:"\n              ml-3\n              transition-all duration-800 ease-[cubic-bezier(0.34,1.56,0.64,1)] delay-1000\n              ".concat(A?"translate-x-0 opacity-100":"translate-x-6 opacity-0","\n            "),children:[(0,o.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-yellow-800 mb-2 transition-all duration-300 hover:text-yellow-900",children:"Third-Party Advertising Cookies"}),(0,o.jsx)("p",{className:"text-sm sm:text-base text-yellow-700 leading-relaxed transition-all duration-300 hover:text-yellow-800",children:'This website uses third party advertising cookies to serve you relevant ads. You may opt-out from these third party ad cookies by clicking the "Opt-out" button below. If you have a Pack Move GO account, you may opt-out of the "sale" or "sharing" of your data here.'})]})]})}),(0,o.jsx)("div",{className:"\n          bg-red-50 border border-red-200 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6\n          transition-all duration-1000 ease-[cubic-bezier(0.34,1.56,0.64,1)] delay-1100\n          ".concat(A?"translate-y-0 opacity-100 scale-100":"translate-y-8 opacity-0 scale-90","\n          hover:shadow-lg hover:scale-[1.02] hover:bg-red-100\n        "),children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"\n              flex-shrink-0\n              transition-all duration-800 ease-[cubic-bezier(0.68,-0.55,0.265,1.55)] delay-1200\n              ".concat(A?"scale-100 rotate-0":"scale-0 rotate-360","\n            "),children:(0,o.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-red-600 mr-2 transition-all duration-300 hover:scale-110 hover:text-red-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,o.jsx)("span",{className:"\n              text-sm sm:text-base text-red-800 font-medium\n              transition-all duration-800 ease-[cubic-bezier(0.34,1.56,0.64,1)] delay-1300\n              ".concat(A?"translate-x-0 opacity-100":"translate-x-6 opacity-0","\n            "),children:e?"You are currently opted out of all cookies":"Please make a choice about cookie preferences"})]})}),(0,o.jsxs)("div",{className:"\n          flex flex-col sm:flex-row gap-3 sm:gap-4\n          transition-all duration-700 ease-out delay-1200\n          ".concat(A?"translate-y-0 opacity-100":"translate-y-8 opacity-0","\n        "),children:[(0,o.jsxs)("button",{onClick:S,disabled:y,className:"\n              flex-1 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-semibold \n              py-3 sm:py-3 px-4 sm:px-6 rounded-lg transition-all duration-300 flex items-center justify-center\n              min-h-[48px] touch-manipulation transform\n              ".concat(y?"opacity-50 cursor-not-allowed":"hover:bg-blue-700 active:bg-blue-800 hover:scale-105 hover:shadow-lg","\n              ").concat("accept"===T?"ring-4 ring-blue-300 ring-offset-2 scale-105 shadow-lg":"","\n              ").concat(A?"translate-x-0":"translate-x-8","\n            "),style:{transitionDelay:A?"1300ms":"0ms"},children:[(0,o.jsx)("svg",{className:"\n              w-4 h-4 sm:w-5 sm:h-5 mr-2 flex-shrink-0\n              transition-all duration-300 ease-out\n              ".concat("accept"===T?"scale-110 rotate-12":"scale-100 rotate-0","\n            "),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,o.jsx)("span",{className:"\n              text-sm sm:text-base\n              transition-all duration-300 ease-out\n              ".concat("accept"===T?"font-bold":"font-semibold","\n            "),children:y&&"accept"===T?"Opting In...":"Opt In to All Cookies"})]}),(0,o.jsx)("button",{onClick:I,disabled:y,className:"\n              flex-1 bg-gray-200 hover:bg-gray-300 active:bg-gray-400 text-gray-800 font-semibold \n              py-3 sm:py-3 px-4 sm:px-6 rounded-lg transition-all duration-300 min-h-[48px] touch-manipulation transform\n              ".concat(y?"opacity-50 cursor-not-allowed":"hover:bg-gray-300 active:bg-gray-400 hover:scale-105 hover:shadow-lg","\n              ").concat("custom"===T?"ring-4 ring-gray-300 ring-offset-2 scale-105 shadow-lg":"","\n              ").concat(A?"translate-x-0":"translate-x-8","\n            "),style:{transitionDelay:A?"1400ms":"0ms"},children:(0,o.jsx)("span",{className:"\n              text-sm sm:text-base\n              transition-all duration-300 ease-out\n              ".concat("custom"===T?"font-bold":"font-semibold","\n            "),children:"Manage Preferences"})})]}),t&&!e&&(0,o.jsx)("div",{className:"\n            mt-3 sm:mt-4 text-center\n            transition-all duration-700 ease-out delay-1500\n            ".concat(A?"translate-y-0 opacity-100":"translate-y-6 opacity-0","\n          "),children:(0,o.jsx)("button",{onClick:N,disabled:y,className:"\n                text-sm sm:text-base text-gray-500 hover:text-gray-700 active:text-gray-800 underline\n                py-2 px-3 touch-manipulation transition-all duration-300 transform\n                ".concat(y?"opacity-50 cursor-not-allowed":"hover:text-gray-700 active:text-gray-800 hover:scale-105","\n                ").concat(A?"translate-x-0":"translate-x-4","\n              "),style:{transitionDelay:A?"1600ms":"0ms"},children:"Dismiss for 30 minutes"})}),(0,o.jsx)("div",{className:"\n          mt-4 sm:mt-6 pt-3 sm:pt-4 border-t border-gray-200\n          transition-all duration-700 ease-out delay-1700\n          ".concat(A?"translate-y-0 opacity-100":"translate-y-6 opacity-0","\n        "),children:(0,o.jsxs)("p",{className:"\n            text-xs sm:text-sm text-gray-600 text-center leading-relaxed\n            transition-all duration-600 ease-out delay-1800\n            ".concat(A?"translate-y-0 opacity-100":"translate-y-4 opacity-0","\n          "),children:["By opting in, you agree to our"," ",(0,o.jsx)("a",{href:"/privacy",className:"text-blue-600 hover:text-blue-800 active:text-blue-900 underline touch-manipulation transition-all duration-300 hover:scale-105",children:"Privacy Policy"})," ","and"," ",(0,o.jsx)("a",{href:"/terms",className:"text-blue-600 hover:text-blue-800 active:text-blue-900 underline touch-manipulation transition-all duration-300 hover:scale-105",children:"Terms of Service"})]})})]})}):w?(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Loading cookie preferences..."})]})}):null}},2202:(e,t,a)=>{a.d(t,{Ap:()=>i,GI:()=>r,hS:()=>n}),a(4232);class o{addFailedEndpoint(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.failedEndpoints.add(e),t&&(this.is503Error=!0)}setModalShown(e){this.modalShown=e}isModalShown(){return this.modalShown}getFailedEndpoints(){return Array.from(this.failedEndpoints)}is503ErrorOccurred(){return this.is503Error}clear(){this.failedEndpoints.clear(),this.is503Error=!1,this.modalShown=!1}hasFailures(){return this.failedEndpoints.size>0}constructor(){this.failedEndpoints=new Set,this.is503Error=!1,this.modalShown=!1}}let s=new o;function n(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{showModal:o=!0,logError:n=!0,context:i="API Call"}=a,r=e instanceof Error?e.message:"Unknown error",l=r.includes("503")||r.includes("Service Unavailable")||r.includes("Failed to fetch")||r.includes("ERR_CONNECTION_REFUSED")||r.includes("ECONNREFUSED")||(null==e?void 0:e.statusCode)===503||(null==e?void 0:e.is503Error)===!0;s.addFailedEndpoint(t,l);let c=(null==e?void 0:e.failedEndpoints)||[];null==e||e.attemptedEndpoints;let u=null==e?void 0:e.primaryError,d={endpoint:c.length>0?c.join(", "):t,error:c.length>0?"Failed APIs: ".concat(c.join(", "),"\nPrimary: ").concat(c[0]||t,"\n\n").concat((null==u?void 0:u.message)||r):r,timestamp:Date.now(),context:i,is503Error:l,failedEndpoints:c.length>0?c:s.getFailedEndpoints()};n&&console.error("\uD83D\uDD27 ".concat(i," Error for ").concat(t,":"),e);let h=function(){try{let e=localStorage.getItem("packmovego-cookie-preferences");if(e){let t=JSON.parse(e);return!0===t.hasMadeChoice&&!1===t.hasOptedOut}return!1}catch(e){return console.warn("\uD83D\uDD27 Error checking cookie consent:",e),!1}}();if(o&&h&&!s.isModalShown()){s.setModalShown(!0),sessionStorage.setItem("api-failed-after-consent","true");let e=new CustomEvent("api-failed-after-consent",{detail:d});window.dispatchEvent(e)}else if(o&&h&&s.isModalShown());else if(o&&!h){let e="api-error-".concat(t,"-").concat(Date.now());sessionStorage.setItem(e,JSON.stringify(d)),sessionStorage.setItem("pending-api-errors","true")}}function i(){return s.getFailedEndpoints()}function r(){return s.is503ErrorOccurred()}},3126:(e,t,a)=>{a.d(t,{n:()=>r});let o=new Map,s={maxSize:200,defaultTTL:6e5,version:"0.0",compressionThreshold:512,adaptiveTTL:!0},n={COOKIE_CONSENT:"cookie-consent-status",API_RESPONSES:"api-responses",BANNER_TIMER:"banner-timer",USER_PREFERENCES:"user-preferences"};class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}get(e){let t=performance.now(),a=o.get(e);return a?Date.now()-a.timestamp>a.ttl||a.version!==s.version?(o.delete(e),this.cacheMisses++,this.updateResponseTime(performance.now()-t),null):(a.accessCount++,a.lastAccessed=Date.now(),s.adaptiveTTL&&this.applyAdaptiveTTL(a),this.cacheHits++,this.updateResponseTime(performance.now()-t),a.data):(this.cacheMisses++,this.updateResponseTime(performance.now()-t),null)}set(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.defaultTTL;this.cleanup();let n=JSON.stringify(t),i=new Blob([n]).size,r=t;if(i>s.compressionThreshold)try{let e=this.compressData(n);if(e.length<n.length){r=e;let t=new Blob([e]).size;this.compressionSavings+=i-t,i=t}}catch(t){console.warn("Compression failed for cache entry:",e)}this.totalUncompressedSize+=new Blob([JSON.stringify(t)]).size,o.size>=s.maxSize&&this.evictOldest();let l={data:r,timestamp:Date.now(),ttl:a,version:s.version,accessCount:0,lastAccessed:Date.now(),size:i};o.set(e,l)}compressData(e){if(e.length<100)return e;let t="",a=1,o=e[0];for(let s=1;s<e.length;s++)e[s]===o?a++:(a>3?t+="".concat(a).concat(o):t+=o.repeat(a),o=e[s],a=1);return a>3?t+="".concat(a).concat(o):t+=o.repeat(a),t.length<e.length?t:e}decompressData(e){if("string"!=typeof e)return e;try{let t="",a=0;for(;a<e.length;)if(/\d/.test(e[a])){let o="";for(;a<e.length&&/\d/.test(e[a]);)o+=e[a],a++;a<e.length&&(t+=e[a].repeat(parseInt(o)),a++)}else t+=e[a],a++;return JSON.parse(t)}catch(t){return e}}applyAdaptiveTTL(e){let t=Date.now()-e.timestamp;if(e.accessCount/Math.max(t/1e3,1)>.1){let t=Math.min(1.5*e.ttl,18e5);t>e.ttl&&(e.ttl=t,this.adaptiveTTLAdjustments++)}}evictOldest(){let e=Array.from(o.entries());e.forEach(e=>{let[,t]=e,a=Date.now()-t.timestamp,o=t.accessCount/Math.max(a/1e3,1),s=1/(Date.now()-t.lastAccessed+1),n=t.size/1024;t.evictionScore=.4*o+.4*s-.2*n}),e.sort((e,t)=>(e[1].evictionScore||0)-(t[1].evictionScore||0));let t=Math.ceil(.2*s.maxSize);for(let a=0;a<t&&a<e.length;a++)o.delete(e[a][0])}updateResponseTime(e){this.totalResponseTime+=e,this.responseCount++}getStats(){let e=this.cacheHits+this.cacheMisses,t=e>0?this.cacheHits/e*100:0,a=this.responseCount>0?this.totalResponseTime/this.responseCount:0,s=0;for(let e of o.values())s+=e.size;let n=this.totalUncompressedSize>0?(this.totalUncompressedSize-s)/this.totalUncompressedSize*100:0;return{totalRequests:e,hits:this.cacheHits,misses:this.cacheMisses,hitRate:t,averageResponseTime:a,memoryUsage:s,compressionRatio:n,adaptiveTTLAdjustments:this.adaptiveTTLAdjustments}}getPerformanceReport(){let e=this.getStats(),t=Math.floor((Date.now()-this.cacheStartTime)/1e3);return"\n\uD83D\uDCCA Cache Performance Report\n==========================\n⏱️  Uptime: ".concat(t,"s\n\uD83D\uDCE6 Size: ").concat(o.size,"/").concat(s.maxSize," items\n\uD83C\uDFAF Hit Rate: ").concat(e.hitRate.toFixed(1),"%\n⚡ Avg Response Time: ").concat(e.averageResponseTime.toFixed(2),"ms\n\uD83D\uDCBE Memory Usage: ").concat((e.memoryUsage/1024).toFixed(1),"KB\n\uD83D\uDDDC️  Compression Savings: ").concat(e.compressionRatio.toFixed(1),"%\n\uD83D\uDD04 Adaptive TTL Adjustments: ").concat(e.adaptiveTTLAdjustments,"\n\uD83D\uDCC8 Total Requests: ").concat(e.totalRequests,"\n✅ Hits: ").concat(e.hits,"\n❌ Misses: ").concat(e.misses,"\n    ").trim()}resetStats(){this.cacheHits=0,this.cacheMisses=0,this.cacheStartTime=Date.now(),this.totalResponseTime=0,this.responseCount=0,this.adaptiveTTLAdjustments=0,this.compressionSavings=0,this.totalUncompressedSize=0}cacheApiResponse(e,t,a){let o="".concat(n.API_RESPONSES,":").concat(e);this.set(o,t,a)}getCachedApiResponse(e){let t="".concat(n.API_RESPONSES,":").concat(e),a=this.get(t);return a?this.decompressData(a):null}cacheCookieConsent(e){this.set(n.COOKIE_CONSENT,e,3e4)}getCachedCookieConsent(){return this.get(n.COOKIE_CONSENT)}cacheBannerTimer(e){this.set(n.BANNER_TIMER,e,1e3)}getCachedBannerTimer(){return this.get(n.BANNER_TIMER)}cacheUserPreferences(e){this.set(n.USER_PREFERENCES,e,6e5)}getCachedUserPreferences(){return this.get(n.USER_PREFERENCES)}invalidateApiCache(){for(let[e]of o.entries())e.startsWith("".concat(n.API_RESPONSES,":"))&&o.delete(e)}invalidateApiEndpoint(e){let t="".concat(n.API_RESPONSES,":").concat(e);o.delete(t)}delete(e){return o.delete(e)}clear(){o.clear(),this.cacheHits=0,this.cacheMisses=0,this.totalResponseTime=0,this.responseCount=0,this.adaptiveTTLAdjustments=0,this.compressionSavings=0,this.totalUncompressedSize=0,this.cacheStartTime=Date.now()}clearOnOffline(){"undefined"==typeof navigator||navigator.onLine||(console.log("\uD83D\uDD04 Going offline - clearing API cache"),this.clear())}isOnline(){return"undefined"==typeof navigator||navigator.onLine}forceClear(){console.log("\uD83D\uDD04 Manually clearing API cache"),this.clear()}cleanup(){let e=Date.now();for(let[t,a]of o.entries())e-a.timestamp>a.ttl&&o.delete(t)}constructor(){this.cacheHits=0,this.cacheMisses=0,this.cacheStartTime=Date.now(),this.totalResponseTime=0,this.responseCount=0,this.adaptiveTTLAdjustments=0,this.compressionSavings=0,this.totalUncompressedSize=0}}let r=i.getInstance();Date.now()},3177:(e,t,a)=>{a.r(t),a.d(t,{API_ENDPOINTS:()=>b,APIsw:()=>k,ENV_CONFIG:()=>R,addModalStateListener:()=>Z,api:()=>S,checkAuthStatus:()=>x,checkConsentMiddleware:()=>ec,checkHealth:()=>P,checkHealthWithCache:()=>eo,consentAwareMiddleware:()=>eu,getAbout:()=>B,getAboutPageData:()=>z,getApiBlocked:()=>el,getApiFailureModalProps:()=>Y,getApiKey:()=>c,getAuthHeaders:()=>K,getBlog:()=>L,getConfig:()=>q,getContact:()=>H,getContactPageData:()=>J,getCurrentPageName:()=>et,getGlobal503Status:()=>g,getHomePageData:()=>W,getLocations:()=>M,getNav:()=>D,getReferral:()=>O,getReviews:()=>U,getServices:()=>_,getSigninHost:()=>u,getSupplies:()=>j,getTrackedApiCalls:()=>ee,getUser:()=>F,healthCheckMiddleware:()=>en,isApiGlobally503:()=>m,isAuthenticated:()=>V,login:()=>I,logout:()=>N,performGlobalHealthCheck:()=>E,preTrackRoutesMiddleware:()=>ei,removeModalStateListener:()=>X,resetApiCallTracking:()=>ea,resetGlobal503Status:()=>v,resetHealthGate:()=>ed,setApiBlocked:()=>er,setGlobal503Status:()=>p,startPageTracking:()=>$,testConnection:()=>G,trackApiCall:()=>Q,withHealthCheck:()=>es});var o=a(2202),s=a(3126);function n(e){if(!(e instanceof Error))return!1;let t=e.message.toLowerCase();return t.includes("failed to fetch")||t.includes("err_connection_refused")||t.includes("network")||t.includes("connection")||t.includes("econnrefused")||t.includes("fetch")||t.includes("timeout")||t.includes("econnreset")}function i(e){if(!(e instanceof Error))return!1;let t=e.message.toLowerCase();return t.includes("503")||t.includes("service unavailable")||t.includes("temporarily unavailable")||(null==e?void 0:e.statusCode)===503||(null==e?void 0:e.is503Error)===!0||n(e)}function r(e,t){let a=Error("503 Service Unavailable: ".concat(e));return a.statusCode=503,a.is503Error=!0,t&&(a.originalError=t,a.originalMessage=t instanceof Error?t.message:String(t)),a}var l=a(5364);let c=()=>((e,t)=>{if(void 0!==l&&l.env&&l.env[e])return l.env[e];let a="__".concat(e.replace("VITE_",""),"__");return window[a]?window[a]:window.__VITE_ENV__&&window.__VITE_ENV__[e]?window.__VITE_ENV__[e]:t||""})("VITE_API_KEY_FRONTEND")||"",u=()=>"https://localhost:3000/signin",d=!1,h=null,p=e=>{d=e},g=()=>d,m=()=>d,E=async()=>h||(h=(async()=>{try{let{api:e}=await Promise.resolve().then(a.bind(a,3177)),t=await e.checkHealth();if(t&&t.error)return p(!0),!1;return p(!1),!0}catch(e){return p(!0),!1}})()),v=()=>{p(!1),h=null};{let e=console.error,t=console.warn,a=console.log,o=e=>{let t=e.toLowerCase();return t.includes("err_connection_refused")||t.includes("failed to fetch")||t.includes("net::err_connection_refused")||t.includes("get https://localhost:3000/v0/health net::err_connection_refused")||t.includes("localhost:3000")||t.includes("err_network")||t.includes("err_internet_disconnected")||t.includes("connection refused")||t.includes("network error")||t.includes("fetch failed")||t.includes("failed to load resource")||t.includes("understand this error")||t.includes("service temporarily unavailable")||t.includes("api is globally unavailable")||t.includes("service.apisw.ts:190")||t.includes("window.fetch @ service.apisw.ts:190")};console.error=function(){for(var t,a=arguments.length,s=Array(a),n=0;n<a;n++)s[n]=arguments[n];!o((null==(t=s[0])?void 0:t.toString())||"")&&(o(s.map(e=>(null==e?void 0:e.toString())||"").join(" "))||e.apply(console,s))},console.warn=function(){for(var e,a=arguments.length,s=Array(a),n=0;n<a;n++)s[n]=arguments[n];!o((null==(e=s[0])?void 0:e.toString())||"")&&(o(s.map(e=>(null==e?void 0:e.toString())||"").join(" "))||t.apply(console,s))},console.log=function(){for(var e,t=arguments.length,s=Array(t),n=0;n<t;n++)s[n]=arguments[n];!o((null==(e=s[0])?void 0:e.toString())||"")&&(o(s.map(e=>(null==e?void 0:e.toString())||"").join(" "))||a.apply(console,s))};let s=window.fetch;window.fetch=async function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let n=console.error,i=console.warn,r=console.log;console.error=function(){for(var e,t=arguments.length,a=Array(t),s=0;s<t;s++)a[s]=arguments[s];o((null==(e=a[0])?void 0:e.toString())||"")||n.apply(console,a)},console.warn=function(){for(var e,t=arguments.length,a=Array(t),s=0;s<t;s++)a[s]=arguments[s];o((null==(e=a[0])?void 0:e.toString())||"")||i.apply(console,a)},console.log=function(){for(var e,t=arguments.length,a=Array(t),s=0;s<t;s++)a[s]=arguments[s];o((null==(e=a[0])?void 0:e.toString())||"")||r.apply(console,a)};try{let e=await s.apply(window,t);return console.error=n,console.warn=i,console.log=r,e}catch(e){if(console.error=n,console.warn=i,console.log=r,e instanceof TypeError&&e.message.includes("Failed to fetch"))return new Response(JSON.stringify({error:!0,statusCode:503,message:"Service Unavailable: Connection failed",is503Error:!0,isConnectionError:!0}),{status:503,statusText:"Service Unavailable",headers:{"Content-Type":"application/json"}});throw e}},window.addEventListener("error",e=>{let t=e.message||"",a=e.filename||"",s="".concat(t," ").concat(a).toLowerCase();if(o(t)||o(a)||o(s))return void e.preventDefault()}),window.addEventListener("error",e=>{if(e.target&&e.target!==window){let t=e.target;if(t.src&&t.src.includes("localhost:3000"))return void e.preventDefault()}},!0),window.addEventListener("unhandledrejection",e=>{if(m())return void e.preventDefault();let t=e.reason;if(t&&"object"==typeof t&&o(t.message||t.toString()||""))return void e.preventDefault();if(console.error("\uD83D\uDEA8 Unhandled Promise Rejection:",e.reason),e.reason&&"object"==typeof e.reason){let t=e.reason;(503===t.statusCode||t.is503Error)&&(console.warn("\uD83D\uDEE1️ Preventing crash for 503 error:",t.message),e.preventDefault())}})}let y=new Map,f=new Map,C={maxRetries:3,baseDelay:1e3,maxDelay:1e4,retryableStatusCodes:[503,502,504,0],retryableErrors:["Failed to fetch","ERR_CONNECTION_REFUSED","ERR_NETWORK","timeout"]},w=async function(e,t){let a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C.maxRetries;for(let s=0;s<=o;s++)try{return await e()}catch(i){a=i;let e=A(i);if(!e||s===o)throw s===o&&e&&console.warn("\uD83D\uDD04 [".concat(t,"] Max retries (").concat(o,") exceeded for retryable error")),a;let n=Math.min(C.baseDelay*Math.pow(2,s)+1e3*Math.random(),C.maxDelay);console.warn("\uD83D\uDD04 [".concat(t,"] Attempt ").concat(s+1,"/").concat(o+1," failed, retrying in ").concat(Math.round(n),"ms:"),a.message),await new Promise(e=>setTimeout(e,n))}throw a},A=e=>{if(!(e instanceof Error))return!1;let t=e.message.toLowerCase(),a=C.retryableErrors.some(e=>t.includes(e.toLowerCase())),o=(null==e?void 0:e.statusCode)&&C.retryableStatusCodes.includes(e.statusCode);return a||o||n(e)},R=(()=>{let e=(e,t)=>{if(void 0!==l&&l.env&&l.env[e])return l.env[e];let a="__".concat(e.replace("VITE_",""),"__");return window[a]?window[a]:window.__VITE_ENV__&&window.__VITE_ENV__[e]?window.__VITE_ENV__[e]:t||""},t=t=>{let a=e(t);return""!==a&&("true"===a||"1"===a)},a=t=>{let a=e(t);if(""===a)return 0;let o=parseInt(a,10);return isNaN(o)?0:o},o={API_URL:e("VITE_API_URL")||e("VITE_API_BASE_URL")||"https://localhost:3000",SKIP_BACKEND_CHECK:t("VITE_SKIP_BACKEND_CHECK"),DEV_MODE:e("VITE_DEV_MODE"),APP_NAME:e("VITE_APP_NAME"),APP_VERSION:e("VITE_APP_VERSION"),PORT:e("VITE_PORT"),DEV_HTTPS:t("VITE_DEV_HTTPS"),IS_SSR:t("VITE_IS_SSR"),MODE:e("VITE_MODE"),ENABLE_DEV_TOOLS:t("ENABLE_DEV_TOOLS"),REDUCE_LOGGING:t("VITE_REDUCE_LOGGING"),API_TIMEOUT:a("VITE_API_TIMEOUT"),API_RETRY_ATTEMPTS:a("VITE_API_RETRY_ATTEMPTS"),CACHE_ENABLED:t("VITE_CACHE_ENABLED"),CACHE_TTL:a("VITE_CACHE_TTL"),CACHE_MAX_SIZE:a("VITE_CACHE_MAX_SIZE"),API_KEY_FRONTEND:c()};return o.API_URL&&!/^https?:\/\//i.test(o.API_URL)&&(o.API_URL="http://".concat(o.API_URL)),"development"===o.DEV_MODE&&(console.log("\uD83D\uDD27 [API-CONFIG] Environment Configuration Loaded:"),console.log("   • API_URL:",o.API_URL),console.log("   • SKIP_BACKEND_CHECK:",o.SKIP_BACKEND_CHECK),console.log("   • DEV_MODE:",o.DEV_MODE),console.log("   • PORT:",o.PORT),console.log("   • API_KEY_FRONTEND:",o.API_KEY_FRONTEND?"set (length: "+o.API_KEY_FRONTEND.length+")":"not set"),console.log("   • import.meta.env available:",!1)),o})();"development"===R.DEV_MODE||l.env;class T{static getInstance(){return T.instance||(T.instance=new T),T.instance}loadStoredToken(){try{if(window.localStorage){let e=localStorage.getItem("packmovego_jwt_token");e&&(this.token=JSON.parse(e),this.token&&this.token.expiresAt<Date.now()&&this.clearToken())}}catch(e){console.warn("Failed to load stored JWT token:",e),this.clearToken()}}setToken(e){this.token=e;try{window.localStorage&&localStorage.setItem("packmovego_jwt_token",JSON.stringify(e))}catch(e){console.warn("Failed to store JWT token:",e)}}getToken(){return!this.token||this.token.expiresAt<Date.now()?(this.clearToken(),null):this.token.token}getUser(){var e;return(null==(e=this.token)?void 0:e.user)||null}isAuthenticated(){return null!==this.getToken()}clearToken(){this.token=null;try{window.localStorage&&localStorage.removeItem("packmovego_jwt_token")}catch(e){console.warn("Failed to clear JWT token:",e)}}getAuthHeaders(){let e=this.getToken();return e?{Authorization:"Bearer ".concat(e)}:{}}needsRefresh(){return!!this.token&&this.token.expiresAt-Date.now()<3e5}constructor(){this.token=null,this.loadStoredToken()}}let b={AUTH:{LOGIN:"/auth/login",LOGOUT:"/auth/logout",STATUS:"/auth/status",REFRESH:"/auth/refresh"},PUBLIC:{NAV:"/public/nav",SERVICES:"/public/services",HEALTH:"/public/health",ABOUT:"/public/about",CONTACT:"/public/contact",REFERRAL:"/public/referral",BLOG:"/public/blog",REVIEWS:"/public/reviews",LOCATIONS:"/public/locations",SUPPLIES:"/public/supplies",TESTIMONIALS:"/public/testimonials",SERVICE_AREAS:"/v0/serviceAreas"},PRIVATE:{NAV:"/v0/nav",SERVICES:"/v0/services",HEALTH:"/health",ABOUT:"/v0/about",CONTACT:"/v0/contact",REFERRAL:"/v0/referral",BLOG:"/v0/blog",REVIEWS:"/v0/reviews",LOCATIONS:"/v0/locations",SUPPLIES:"/v0/supplies",TESTIMONIALS:"/v0/testimonials"}};class k{static getInstance(){return k.instance||(k.instance=new k),k.instance}setApiBlocked(e){this.isApiBlocked=e,this.isDevMode&&!R.REDUCE_LOGGING&&console.log("\uD83D\uDEAB API blocking state changed: ".concat(e?"BLOCKED":"ALLOWED"))}getApiBlocked(){return this.isApiBlocked}checkConsentMiddleware(){if(this.isApiBlocked){let e=Error("503 Service Unavailable: API calls blocked due to cookie consent - user must opt in first");throw e.statusCode=503,e.is503Error=!0,e.isConsentBlocked=!0,console.log("\uD83C\uDF6A [CONSENT-BLOCK] API call blocked due to lack of cookie consent"),e}}consentAwareMiddleware(e,t){return async(a,s,n)=>{try{return this.checkConsentMiddleware(),await n()}catch(a){if(console.error("❌ [CONSENT-MIDDLEWARE] ".concat(t," Error for ").concat(e,":"),a),a instanceof Error&&a.message.includes("cookie consent")&&a.message.includes("user must opt in first"))throw console.log("\uD83C\uDF6A [CONSENT-MIDDLEWARE] Consent required for ".concat(e," - not showing API failure modal")),a;if(a instanceof Error&&(a.message.includes("503")||a.message.includes("Service Unavailable")||a.message.includes("temporarily unavailable"))){console.log("\uD83D\uDEA8 [CONSENT-MIDDLEWARE] 503 Error detected for ".concat(e,", showing API failure modal")),this.showApiFailureModal([e],!0);let s=Error("503 Service Unavailable: ".concat(e));s.failedEndpoints=[e],s.attemptedEndpoints=[e],s.primaryError=a,(0,o.hS)(s,e,{context:t,showModal:!1,logError:!0})}else(0,o.hS)(a,e,{context:t,showModal:!1,logError:!0});throw a}}}async checkApiHealth(){let e=Date.now();if(this.apiIsDown){if(e-this.lastHealthCheckTime<this.healthCheckCooldown)return console.log("\uD83D\uDD04 [API-HEALTH] API is down, cooldown active - skipping health check"),!1;this.apiIsDown=!1}if(this.healthCheckInProgress)return!1;try{this.healthCheckInProgress=!0,this.lastHealthCheckTime=e;let t=await this.checkHealth();if(t&&t.error)return this.apiIsDown=!0,p(!0),!1;return this.apiIsDown=!1,!0}catch(e){return this.apiIsDown=!0,p(!0),!1}finally{this.healthCheckInProgress=!1}}resetHealthGate(){this.apiIsDown=!1,this.healthCheckInProgress=!1,this.lastHealthCheckTime=0,this.failedEndpoints.clear(),this.endpointFailureTimes.clear(),this.globalRequestBlocked=!1,this.globalBlockTime=0,this.pendingRequests.clear(),this.requestTimeouts.forEach(e=>clearTimeout(e)),this.requestTimeouts.clear()}isEndpointInCircuitBreaker(e){if(!this.failedEndpoints.has(e))return!1;let t=this.endpointFailureTimes.get(e)||0;return!(Date.now()-t>this.endpointCooldown)||(this.failedEndpoints.delete(e),this.endpointFailureTimes.delete(e),!1)}addEndpointToCircuitBreaker(e){this.failedEndpoints.add(e),this.endpointFailureTimes.set(e,Date.now())}isGlobalRequestBlocked(){return!!this.globalRequestBlocked&&(!(Date.now()-this.globalBlockTime>this.globalBlockCooldown)||(this.globalRequestBlocked=!1,this.globalBlockTime=0,!1))}activateGlobalRequestBlock(){this.globalRequestBlocked=!0,this.globalBlockTime=Date.now()}getRequestKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.method||"GET",o=t.body?JSON.stringify(t.body):"";return"".concat(a,":").concat(e,":").concat(o)}isRequestPending(e){return this.pendingRequests.has(e)}addPendingRequest(e,t){this.pendingRequests.set(e,t);let a=setTimeout(()=>{this.pendingRequests.delete(e),this.requestTimeouts.delete(e)},3e4);return this.requestTimeouts.set(e,a),t}removePendingRequest(e){this.pendingRequests.delete(e);let t=this.requestTimeouts.get(e);t&&(clearTimeout(t),this.requestTimeouts.delete(e))}async makeRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return await this.makeRequestInternal(e,t,a)}async makeRequestInternal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(m()){let e=Error("503 Service Unavailable: API is globally unavailable");throw e.statusCode=503,e.is503Error=!0,e}let o=this.getRequestKey(e,t);if(this.isRequestPending(o))return this.pendingRequests.get(o);if("/v0/health"!==e&&this.isGlobalRequestBlocked()){let t=Error("503 Service Unavailable: API is temporarily unavailable (global block)");throw t.statusCode=503,t.is503Error=!0,t.isGlobalBlock=!0,console.log("\uD83D\uDEAB [GLOBAL-BLOCK] Blocking request to ".concat(e," - global block active")),t}if("/v0/health"!==e&&this.isEndpointInCircuitBreaker(e)){let t=Error("503 Service Unavailable: ".concat(e," is temporarily unavailable (circuit breaker)"));throw t.statusCode=503,t.is503Error=!0,t.isCircuitBreaker=!0,console.log("\uD83D\uDD12 [CIRCUIT-BREAKER] Blocking request to ".concat(e," - in cooldown period")),t}if("/v0/health"!==e&&this.checkConsentMiddleware(),"/v0/health"!==e&&!await this.checkApiHealth()){this.activateGlobalRequestBlock(),this.addEndpointToCircuitBreaker(e);let t=Error("503 Service Unavailable: API health check failed");throw t.statusCode=503,t.is503Error=!0,t}let s=((e,t)=>{let a=e.replace(/\/+$/,""),o=t.startsWith("/")?t:"/".concat(t);return"".concat(a).concat(o)})(R.API_URL,e),n=this.executeRequestWithRetry(s,e,t,a),i=this.addPendingRequest(o,n);return i.finally(()=>{this.removePendingRequest(o)}),i}async executeRequestWithRetry(e,t,a,o){return this.shouldRetryEndpoint(t)?await w(async()=>await this.executeRequestWithDeduplication(e,t,a,o),"API Request: ".concat(t)):await this.executeRequestWithDeduplication(e,t,a,o)}shouldRetryEndpoint(e){return["/v0/health","/v0/locations","/v0/service-areas","/v0/services","/v0/supplies"].some(t=>e.includes(t))}async executeRequestWithDeduplication(e,t,a,o){this.trackApiCall(t);let s=((e,t)=>{let a=(null==t?void 0:t.method)||"GET",o=(null==t?void 0:t.body)?JSON.stringify(t.body):"";return"".concat(a,":").concat(e,":").concat(o)})(t,a);if(y.has(s))return this.isDevMode&&!R.REDUCE_LOGGING&&console.log("\uD83D\uDD04 Reusing pending request: ".concat(t)),y.get(s);(e=>{let t=Date.now();return t-(f.get(e)||0)<1e3||(f.set(e,t),!1)})(t)&&(this.isDevMode&&!R.REDUCE_LOGGING&&console.log("⏳ Throttling request to ".concat(t," (rate limited)")),await new Promise(e=>setTimeout(e,1e3)));let n=this.executeRequest(e,a,o);return y.set(s,n),n.finally(()=>{y.delete(s)}),n}async makePublicRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.makePublicRequestInternal(e,t)}async makePublicRequestInternal(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(m()){let e=Error("503 Service Unavailable: API is globally unavailable");throw e.statusCode=503,e.is503Error=!0,e}let a=this.getRequestKey(e,t);if(this.isRequestPending(a))return this.pendingRequests.get(a);if("/v0/health"!==e&&this.isGlobalRequestBlocked()){let t=Error("503 Service Unavailable: API is temporarily unavailable (global block)");throw t.statusCode=503,t.is503Error=!0,t.isGlobalBlock=!0,console.log("\uD83D\uDEAB [GLOBAL-BLOCK] Blocking public request to ".concat(e," - global block active")),t}if("/v0/health"!==e&&this.isEndpointInCircuitBreaker(e)){let t=Error("503 Service Unavailable: ".concat(e," is temporarily unavailable (circuit breaker)"));throw t.statusCode=503,t.is503Error=!0,t.isCircuitBreaker=!0,console.log("\uD83D\uDD12 [CIRCUIT-BREAKER] Blocking public request to ".concat(e," - in cooldown period")),t}if("/v0/health"!==e&&this.checkConsentMiddleware(),"/v0/health"!==e&&!await this.checkApiHealth()){this.activateGlobalRequestBlock(),this.addEndpointToCircuitBreaker(e);let t=Error("503 Service Unavailable: API health check failed");throw t.statusCode=503,t.is503Error=!0,t}let o=((e,t)=>{let a=e.replace(/\/+$/,""),o=t.startsWith("/")?t:"/".concat(t);return"".concat(a).concat(o)})(R.API_URL,e),s=this.executePublicRequest(o,t),n=this.addPendingRequest(a,s);return n.finally(()=>{this.removePendingRequest(a)}),n}async executeRequest(e,t,a){let o={"Content-Type":"application/json",Accept:"application/json","x-api-key":c()};if(this.isDevMode&&!R.REDUCE_LOGGING){let e=c();console.log("\uD83D\uDD11 API Key Configuration:",{hasApiKey:!!e,apiKeyLength:(null==e?void 0:e.length)||0,apiKeyPrefix:(null==e?void 0:e.substring(0,10))+"...",fullApiKey:e,headers:o})}a&&Object.assign(o,this.jwtAuth.getAuthHeaders());let s={method:"GET",headers:o,credentials:"include",...t},n=async e=>{this.isDevMode&&!R.REDUCE_LOGGING&&console.log("\uD83C\uDF10 API Request: ".concat(e));let t=console.error,a=console.warn,o=console.log;console.error=function(){for(var e,a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];let n=(null==(e=o[0])?void 0:e.toString())||"";n.includes("ERR_CONNECTION_REFUSED")||n.includes("Failed to fetch")||n.includes("net::ERR_CONNECTION_REFUSED")||n.includes("GET https://localhost:3000/v0/health net::ERR_CONNECTION_REFUSED")||n.includes("localhost:3000")||n.includes("ERR_NETWORK")||n.includes("ERR_INTERNET_DISCONNECTED")||t.apply(console,o)},console.warn=function(){for(var e,t=arguments.length,o=Array(t),s=0;s<t;s++)o[s]=arguments[s];let n=(null==(e=o[0])?void 0:e.toString())||"";n.includes("ERR_CONNECTION_REFUSED")||n.includes("Failed to fetch")||n.includes("net::ERR_CONNECTION_REFUSED")||n.includes("GET https://localhost:3000/v0/health net::ERR_CONNECTION_REFUSED")||n.includes("localhost:3000")||n.includes("ERR_NETWORK")||n.includes("ERR_INTERNET_DISCONNECTED")||a.apply(console,o)},console.log=function(){for(var e,t=arguments.length,a=Array(t),s=0;s<t;s++)a[s]=arguments[s];let n=(null==(e=a[0])?void 0:e.toString())||"";n.includes("ERR_CONNECTION_REFUSED")||n.includes("Failed to fetch")||n.includes("net::ERR_CONNECTION_REFUSED")||n.includes("GET https://localhost:3000/v0/health net::ERR_CONNECTION_REFUSED")||n.includes("localhost:3000")||n.includes("ERR_NETWORK")||n.includes("ERR_INTERNET_DISCONNECTED")||o.apply(console,a)};try{let n=await fetch(e,s);return console.error=t,console.warn=a,console.log=o,n}catch(e){if(console.error=t,console.warn=a,console.log=o,e instanceof TypeError&&e.message.includes("Failed to fetch"))return new Response(JSON.stringify({error:!0,statusCode:503,message:"Service Unavailable: Connection failed",is503Error:!0,isConnectionError:!0}),{status:503,statusText:"Service Unavailable",headers:{"Content-Type":"application/json"}});throw e}};try{let t=await n(e);if(t.ok){let a=await t.json();return this.isDevMode&&!R.REDUCE_LOGGING&&console.log("✅ API Success (".concat(e,"):"),a),e.includes("/v0/locations")&&console.log("\uD83D\uDD27 Locations API response details:",{url:e,status:t.status,dataType:typeof a,hasLocations:!!(a&&a.locations),hasServiceTypes:!!(a&&a.serviceTypes),dataKeys:a?Object.keys(a):[]}),a}{if(503===t.status)return await t.json();let e=await this.handleErrorResponse(t);throw Error(e)}}catch(e){throw e}}async executePublicRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={"Content-Type":"application/json",Accept:"application/json","x-api-key":c()};if(this.isDevMode&&!R.REDUCE_LOGGING){let e=c();console.log("\uD83D\uDD11 Public API Key Configuration:",{hasApiKey:!!e,apiKeyLength:(null==e?void 0:e.length)||0,apiKeyPrefix:(null==e?void 0:e.substring(0,10))+"...",fullApiKey:e,headers:a})}let o={method:"GET",headers:a,credentials:"include",...t},s=async e=>{this.isDevMode&&!R.REDUCE_LOGGING&&console.log("\uD83C\uDF10 Public API Request: ".concat(e));let t=console.error,a=console.warn,s=console.log;console.error=function(){for(var e,a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];let n=(null==(e=o[0])?void 0:e.toString())||"";n.includes("ERR_CONNECTION_REFUSED")||n.includes("Failed to fetch")||n.includes("net::ERR_CONNECTION_REFUSED")||n.includes("GET https://localhost:3000/v0/health net::ERR_CONNECTION_REFUSED")||n.includes("localhost:3000")||n.includes("ERR_NETWORK")||n.includes("ERR_INTERNET_DISCONNECTED")||t.apply(console,o)},console.warn=function(){for(var e,t=arguments.length,o=Array(t),s=0;s<t;s++)o[s]=arguments[s];let n=(null==(e=o[0])?void 0:e.toString())||"";n.includes("ERR_CONNECTION_REFUSED")||n.includes("Failed to fetch")||n.includes("net::ERR_CONNECTION_REFUSED")||n.includes("GET https://localhost:3000/v0/health net::ERR_CONNECTION_REFUSED")||n.includes("localhost:3000")||n.includes("ERR_NETWORK")||n.includes("ERR_INTERNET_DISCONNECTED")||a.apply(console,o)},console.log=function(){for(var e,t=arguments.length,a=Array(t),o=0;o<t;o++)a[o]=arguments[o];let n=(null==(e=a[0])?void 0:e.toString())||"";n.includes("ERR_CONNECTION_REFUSED")||n.includes("Failed to fetch")||n.includes("net::ERR_CONNECTION_REFUSED")||n.includes("GET https://localhost:3000/v0/health net::ERR_CONNECTION_REFUSED")||n.includes("localhost:3000")||n.includes("ERR_NETWORK")||n.includes("ERR_INTERNET_DISCONNECTED")||s.apply(console,a)};try{let n=await fetch(e,o);return console.error=t,console.warn=a,console.log=s,n}catch(e){if(console.error=t,console.warn=a,console.log=s,e instanceof TypeError&&e.message.includes("Failed to fetch"))return new Response(JSON.stringify({error:!0,statusCode:503,message:"Service Unavailable: Connection failed",is503Error:!0,isConnectionError:!0}),{status:503,statusText:"Service Unavailable",headers:{"Content-Type":"application/json"}});throw e}};try{let t=await s(e);if(t.ok){let a=await t.json();return this.isDevMode&&!R.REDUCE_LOGGING&&console.log("✅ Public API Success (".concat(e,"):"),a),a}{if(503===t.status)return await t.json();let e=await this.handlePublicErrorResponse(t);throw Error(e)}}catch(e){throw e}}async handlePublicErrorResponse(e){try{let t=(await e.json()).message||e.statusText;if(503===e.status)return this.isDevMode&&!R.REDUCE_LOGGING&&console.warn("⚠️ Public API returned 503 - Service Unavailable"),"HTTP 503: ".concat(t);return"HTTP ".concat(e.status,": ").concat(t)}catch(t){return"HTTP ".concat(e.status,": ").concat(e.statusText)}}async handleErrorResponse(e){try{let t=(await e.json()).message||e.statusText;if(503===e.status){console.warn("⚠️ API returned 503 - Service Unavailable");let a=e.url.replace(R.API_URL,""),s=Error("HTTP 503: ".concat(t));return(0,o.hS)(s,a,{context:"APIsw Service",showModal:!1,logError:!0}),"Service temporarily unavailable (503): ".concat(t)}if(403===e.status)return this.isDevMode&&!R.REDUCE_LOGGING&&console.warn("\uD83D\uDD10 Authentication failed, redirecting to signin"),this.redirectToSignin(),"Authentication required: ".concat(t);if(429===e.status||t.includes("Too many requests"))return this.isDevMode&&!R.REDUCE_LOGGING&&console.warn("⚠️ Rate limited by backend. Consider enabling development API override."),"Rate limited: ".concat(t);return"HTTP ".concat(e.status,": ").concat(t)}catch(t){if(503===e.status){console.warn("⚠️ API returned 503 - Service Unavailable (no JSON response)");let t=e.url.replace(R.API_URL,""),a=Error("HTTP 503: ".concat(e.statusText));return(0,o.hS)(a,t,{context:"APIsw Service",showModal:!1,logError:!0}),"Service temporarily unavailable (503): ".concat(e.statusText)}return"HTTP ".concat(e.status,": ").concat(e.statusText)}}redirectToSignin(){try{let e=R.API_URL.replace("/api","/signin")||"https://localhost:3000/signin";e&&(console.log("\uD83D\uDD10 Redirecting to signin:",e),window.location.href=e)}catch(e){console.error("❌ Failed to redirect to signin:",e)}}async login(e,t){try{let a=await this.makeRequest(b.AUTH.LOGIN,{method:"POST",body:JSON.stringify({email:e,password:t})});if(a&&a.success&&a.token){let e=Date.now()+(a.expiresIn||36e5);this.jwtAuth.setToken({token:a.token,expiresAt:e,user:a.user}),this.isDevMode&&!R.REDUCE_LOGGING&&console.log("\uD83D\uDD10 Login successful, JWT token stored")}return a}catch(e){throw this.isDevMode&&!R.REDUCE_LOGGING&&console.error("\uD83D\uDD10 Login failed:",e),e}}async logout(){try{await this.makeRequest(b.AUTH.LOGOUT,{method:"POST"},!0)}catch(e){this.isDevMode&&!R.REDUCE_LOGGING&&console.warn("⚠️ Server logout failed, but clearing local data:",e)}finally{this.jwtAuth.clearToken()}}async checkAuthStatus(){let e=s.n.getCachedApiResponse(b.AUTH.STATUS);if(e)return console.log("✅ Using cached auth status data"),e;try{let e=await this.makeRequest(b.AUTH.STATUS,{},!0);return e&&(s.n.cacheApiResponse(b.AUTH.STATUS,e,12e4),console.log("\uD83D\uDCE6 Cached auth status data")),e}catch(e){return{success:!1,message:"Not authenticated"}}}async loadInitialData(){try{this.isDevMode&&!R.REDUCE_LOGGING&&console.log("\uD83D\uDE80 Loading initial data (batch request)...");let[e,t,a]=await Promise.allSettled([this.getNav(),this.getServices(),this.checkAuthStatus()]),o={nav:"fulfilled"===e.status?e.value:null,services:"fulfilled"===t.status?t.value:null,authStatus:"fulfilled"===a.status?a.value:null};return this.isDevMode&&!R.REDUCE_LOGGING&&console.log("✅ Initial data loaded:",{nav:!!o.nav,services:!!o.services,authStatus:!!o.authStatus}),o}catch(e){throw this.isDevMode&&!R.REDUCE_LOGGING&&console.error("❌ Failed to load initial data:",e),e}}async getNav(){let e=s.n.getCachedApiResponse(b.PRIVATE.NAV);if(e)return console.log("✅ Using cached navigation data"),e;let t=await this.makeRequest(b.PRIVATE.NAV);return t&&(s.n.cacheApiResponse(b.PRIVATE.NAV,t,6e5),console.log("\uD83D\uDCE6 Cached navigation data")),t}async getServices(){let e=s.n.getCachedApiResponse(b.PUBLIC.SERVICES);if(e)return e;let t=await this.makeRequest(b.PUBLIC.SERVICES);return t&&s.n.cacheApiResponse(b.PUBLIC.SERVICES,t,6e5),t}async checkHealth(){let e=s.n.getCachedApiResponse("/v0/health");if(e)return e;try{let e=await w(async()=>await this.makeRequest("/v0/health"),"Health Check");return e&&s.n.cacheApiResponse("/v0/health",e,3e4),e}catch(t){let e=function(e,t){if(i(e))return e;if(n(e)){let a=Error("503 Service Unavailable: Connection failed for ".concat(t));return a.statusCode=503,a.is503Error=!0,a.isConnectionError=!0,e&&(a.originalError=e,a.originalMessage=e instanceof Error?e.message:String(e)),a}if(function(e){if(!(e instanceof Error))return!1;let t=e.message.toLowerCase();return t.includes("500")||t.includes("501")||t.includes("502")||t.includes("503")||t.includes("504")||t.includes("505")}(e))return r(t,e);if(e instanceof Error){let a=e.message.toLowerCase();if(a.includes("api")||a.includes("request")||a.includes("response")||a.includes("http"))return r(t,e)}return e}(t,"/v0/health");if(i(e))return p(!0),{error:!0,statusCode:503,message:e.message,is503Error:!0,isConnectionError:(null==e?void 0:e.isConnectionError)||!1};throw t}}async getReferral(){return await this.makeRequest(b.PUBLIC.REFERRAL)}async getBlog(){return await this.makeRequest(b.PUBLIC.BLOG)}async getReviews(){return await this.makeRequest(b.PUBLIC.REVIEWS)}async getLocations(){var e,t;let a=s.n.getCachedApiResponse(b.PUBLIC.LOCATIONS);if(a)return console.log("✅ Using cached locations data"),a;console.log("\uD83D\uDD27 APIsw.getLocations() called - fetching from:",b.PUBLIC.LOCATIONS);let o=await this.makeRequest(b.PUBLIC.LOCATIONS);return o&&(s.n.cacheApiResponse(b.PUBLIC.LOCATIONS,o,9e5),console.log("\uD83D\uDCE6 Cached locations data")),console.log("\uD83D\uDD27 APIsw.getLocations() response:",{hasData:!!o,hasLocations:!!(o&&o.locations),hasServiceTypes:!!(o&&o.serviceTypes),locationsCount:(null==o||null==(e=o.locations)?void 0:e.length)||0,serviceTypesCount:(null==o||null==(t=o.serviceTypes)?void 0:t.length)||0}),o}async getSupplies(){var e,t;let a=s.n.getCachedApiResponse(b.PUBLIC.SUPPLIES);if(a)return console.log("✅ Using cached supplies data"),a;console.log("\uD83D\uDD27 APIsw.getSupplies() called - fetching from:",b.PUBLIC.SUPPLIES);let o=await this.makeRequest(b.PUBLIC.SUPPLIES);return o&&(s.n.cacheApiResponse(b.PUBLIC.SUPPLIES,o,6e5),console.log("\uD83D\uDCE6 Cached supplies data")),console.log("\uD83D\uDD27 APIsw.getSupplies() response:",{hasData:!!o,hasSupplies:!!(o&&o.supplies),suppliesCount:(null==o||null==(e=o.supplies)?void 0:e.length)||0,firstSupplyStructure:null==o||null==(t=o.supplies)?void 0:t[0]}),o}async getServiceAreas(){return await this.makePublicRequest(b.PUBLIC.SERVICE_AREAS)}async getAbout(){return await this.makeRequest(b.PUBLIC.ABOUT)}async getContact(){return await this.makeRequest(b.PUBLIC.CONTACT)}async getPrivateNav(){return await this.makeRequest(b.PRIVATE.NAV,{},!0)}async getPrivateServices(){return await this.makeRequest(b.PRIVATE.SERVICES,{},!0)}async getPrivateLocations(){return await this.makeRequest(b.PRIVATE.LOCATIONS,{},!0)}async getPrivateSupplies(){return await this.makeRequest(b.PRIVATE.SUPPLIES,{},!0)}async getPrivateReviews(){return await this.makeRequest(b.PRIVATE.REVIEWS,{},!0)}async getPrivateTestimonials(){return await this.makeRequest(b.PRIVATE.TESTIMONIALS,{},!0)}async getPrivateAbout(){return await this.makeRequest(b.PRIVATE.ABOUT,{},!0)}async getPrivateContact(){return await this.makeRequest(b.PRIVATE.CONTACT,{},!0)}async getPrivateReferral(){return await this.makeRequest(b.PRIVATE.REFERRAL,{},!0)}async getPrivateBlog(){return await this.makeRequest(b.PRIVATE.BLOG,{},!0)}async getHomePageData(){console.log("\uD83D\uDE80 Loading consolidated home page data...");let e=["/v0/services","/v0/recentMoves","/v0/testimonials","/v0/nav","/auth/status"],[t,a,o,s,n]=await Promise.allSettled([this.makeRequest(b.PRIVATE.SERVICES),this.makeRequest("/v0/recentMoves"),this.makeRequest(b.PRIVATE.TESTIMONIALS),this.makeRequest(b.PRIVATE.NAV),this.checkAuthStatus()]),i={services:"fulfilled"===t.status?t.value:null,recentMoves:"fulfilled"===a.status?a.value:null,testimonials:"fulfilled"===o.status?o.value:null,nav:"fulfilled"===s.status?s.value:null,authStatus:"fulfilled"===n.status?n.value:null},r=[],l=[];if("rejected"===t.status&&(r.push("/v0/services"),l.push(t.reason)),"rejected"===a.status&&(r.push("/v0/recentMoves"),l.push(a.reason)),"rejected"===o.status&&(r.push("/v0/testimonials"),l.push(o.reason)),"rejected"===s.status&&(r.push("/v0/nav"),l.push(s.reason)),"rejected"===n.status&&(r.push("/auth/status"),l.push(n.reason)),r.length>0){let t=l[0],a="Home page API failed - attempted endpoints: ".concat(e.join(", "),", failed: ").concat(r.join(", "));console.error("❌ Consolidated home page data failed:",{attemptedEndpoints:e,failedEndpoints:r,primaryError:(null==t?void 0:t.message)||"Unknown error"});let o=Error(a);throw o.failedEndpoints=r,o.attemptedEndpoints=e,o.primaryError=t,o}return console.log("✅ Consolidated home page data loaded:",{services:!!i.services,recentMoves:!!i.recentMoves,testimonials:!!i.testimonials,nav:!!i.nav,authStatus:!!i.authStatus}),i}async getAboutPageData(){try{console.log("\uD83D\uDE80 Loading consolidated about page data...");let[e,t]=await Promise.allSettled([this.makeRequest(b.PRIVATE.ABOUT),this.makeRequest("/v0/recentMoves/total")]),a={about:"fulfilled"===e.status?e.value:null,totalMovesCount:"fulfilled"===t.status?t.value:500};return console.log("✅ Consolidated about page data loaded:",{about:!!a.about,totalMovesCount:a.totalMovesCount}),a}catch(e){throw console.error("❌ Failed to load consolidated about page data:",e),e}}async getContactPageData(){try{console.log("\uD83D\uDE80 Loading consolidated contact page data...");let e={contact:await this.makeRequest(b.PRIVATE.CONTACT)};return console.log("✅ Consolidated contact page data loaded:",{contact:!!e.contact}),e}catch(e){throw console.error("❌ Failed to load consolidated contact page data:",e),e}}showApiFailureModal(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0,o=Array.from(new Set(e));this.modalState={isVisible:!0,failedEndpoints:o,is503Error:t,onClose:a||null},this.notifyModalStateListeners(),this.isDevMode&&!R.REDUCE_LOGGING&&console.log("\uD83D\uDD27 APIsw: Showing API failure modal:",{originalFailedEndpoints:e,uniqueEndpoints:o,is503Error:t,hasOnClose:!!a,currentPage:this.currentPageName,allTrackedCalls:this.getTrackedApiCalls()})}hideApiFailureModal(){this.modalState={isVisible:!1,failedEndpoints:[],is503Error:!1,onClose:null},this.notifyModalStateListeners(),this.isDevMode&&!R.REDUCE_LOGGING&&console.log("\uD83D\uDD27 APIsw: Hiding API failure modal")}getModalState(){return{...this.modalState}}getApiFailureModalProps(){return{isVisible:this.modalState.isVisible,onClose:()=>{this.hideApiFailureModal(),this.modalState.onClose&&this.modalState.onClose()},failedEndpoints:this.modalState.failedEndpoints,is503Error:this.modalState.is503Error}}addModalStateListener(e){this.modalStateListeners.add(e)}removeModalStateListener(e){this.modalStateListeners.delete(e)}notifyModalStateListeners(){this.modalStateListeners.forEach(e=>{try{e()}catch(e){console.error("Error in modal state listener:",e)}})}startPageTracking(e){this.currentPageName!==e&&(this.currentPageName=e,this.pageApiCalls=[])}trackApiCall(e){this.pageApiCalls.includes(e)||this.pageApiCalls.push(e)}getTrackedApiCalls(){return Array.from(this.pageApiCalls)}getCurrentPageName(){return this.currentPageName}resetApiCallTracking(){this.pageApiCalls=[],this.currentPageName="",console.log("\uD83D\uDD27 [API-TRACKING] Reset API call tracking")}async checkHealthWithCache(){let e=Date.now();if("unknown"!==this.healthStatus&&e-this.healthCheckTime<this.HEALTH_CHECK_CACHE_DURATION)return"healthy"===this.healthStatus;try{return console.log("\uD83C\uDFE5 [HEALTH-MIDDLEWARE] Checking API health status..."),await this.checkHealth(),this.healthStatus="healthy",this.healthCheckTime=e,console.log("✅ [HEALTH-MIDDLEWARE] Health check passed"),!0}catch(t){return console.error("❌ [HEALTH-MIDDLEWARE] Health check failed:",t),this.healthStatus="unhealthy",this.healthCheckTime=e,this.trackApiCall("/v0/health"),!1}}async healthCheckMiddleware(e,t,a){let o=e.url||e.path||"/unknown";if(!await this.checkHealthWithCache()){console.log("\uD83D\uDEA8 [HEALTH-MIDDLEWARE] Health check failed, recording all routes as 503");let e=this.getTrackedApiCalls();console.log("\uD83D\uDD27 [HEALTH-MIDDLEWARE] All tracked routes:",e);let s=["/v0/health",...e];console.log("\uD83D\uDD27 [HEALTH-MIDDLEWARE] All failed routes for modal:",s),this.showApiFailureModal(s,!0),t.statusCode=503,t.status=503,t.error=Error("Service Unavailable (503): Health check failed for ".concat(o)),a(Error("Service Unavailable (503): Health check failed for ".concat(o)));return}a()}preTrackRoutesMiddleware(e){e.forEach(e=>{this.trackApiCall(e)})}async withHealthCheck(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!await this.checkHealthWithCache()){console.log("\uD83D\uDEA8 [HEALTH-MIDDLEWARE] Health check failed, recording all routes as 503"),a.forEach(e=>{this.pageApiCalls.includes(e)||this.trackApiCall(e)});let t=["/v0/health",...a];throw this.showApiFailureModal(t,!0),Error("Service Unavailable (503): Health check failed for ".concat(e))}try{return await t()}catch(t){throw console.error("❌ [HEALTH-MIDDLEWARE] API call failed for ".concat(e,":"),t),t}}async testConnection(){try{let e=await this.checkHealth();return{success:!0,data:e,apiUrl:R.API_URL,skipBackendCheck:R.SKIP_BACKEND_CHECK}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error",apiUrl:R.API_URL,skipBackendCheck:R.SKIP_BACKEND_CHECK}}}getConfig(){return{apiUrl:R.API_URL,devMode:this.isDevMode,skipBackendCheck:R.SKIP_BACKEND_CHECK,isAuthenticated:this.jwtAuth.isAuthenticated(),hasToken:!!this.jwtAuth.getToken(),appName:R.APP_NAME,appVersion:R.APP_VERSION,enableDevTools:R.ENABLE_DEV_TOOLS,reduceLogging:R.REDUCE_LOGGING,apiTimeout:R.API_TIMEOUT,cacheEnabled:R.CACHE_ENABLED,cacheTtl:R.CACHE_TTL,cacheMaxSize:R.CACHE_MAX_SIZE}}isAuthenticated(){return this.jwtAuth.isAuthenticated()}getUser(){return this.jwtAuth.getUser()}getAuthHeaders(){return this.jwtAuth.getAuthHeaders()}constructor(){this.modalState={isVisible:!1,failedEndpoints:[],is503Error:!1,onClose:null},this.modalStateListeners=new Set,this.pageApiCalls=[],this.currentPageName="",this.isApiBlocked=!1,this.apiIsDown=!1,this.healthCheckInProgress=!1,this.lastHealthCheckTime=0,this.healthCheckCooldown=3e4,this.failedEndpoints=new Set,this.endpointFailureTimes=new Map,this.endpointCooldown=6e4,this.globalRequestBlocked=!1,this.globalBlockTime=0,this.globalBlockCooldown=3e4,this.pendingRequests=new Map,this.requestTimeouts=new Map,this.healthStatus="unknown",this.healthCheckTime=0,this.HEALTH_CHECK_CACHE_DURATION=3e4,this.jwtAuth=T.getInstance(),this.isDevMode="development"===R.DEV_MODE,this.isDevMode&&!R.REDUCE_LOGGING&&console.log("\uD83D\uDD27 APIsw initialized with config:",{API_URL:R.API_URL,SKIP_BACKEND_CHECK:R.SKIP_BACKEND_CHECK,DEV_MODE:R.DEV_MODE,PORT:R.PORT,IS_SSR:R.IS_SSR,MODE:R.MODE,ENABLE_DEV_TOOLS:R.ENABLE_DEV_TOOLS,API_TIMEOUT:R.API_TIMEOUT,CACHE_ENABLED:R.CACHE_ENABLED})}}let S=k.getInstance(),I=(e,t)=>S.login(e,t),N=()=>S.logout(),x=()=>S.checkAuthStatus(),D=()=>S.getNav(),_=()=>S.getServices(),P=()=>S.checkHealth(),O=()=>S.getReferral(),L=()=>S.getBlog(),U=()=>S.getReviews(),M=()=>S.getLocations(),j=()=>S.getSupplies(),B=()=>S.getAbout(),H=()=>S.getContact(),G=()=>S.testConnection(),q=()=>S.getConfig(),V=()=>S.isAuthenticated(),F=()=>S.getUser(),K=()=>S.getAuthHeaders(),W=()=>S.getHomePageData(),z=()=>S.getAboutPageData(),J=()=>S.getContactPageData(),Y=()=>S.getApiFailureModalProps(),Z=e=>S.addModalStateListener(e),X=e=>S.removeModalStateListener(e),$=e=>S.startPageTracking(e),Q=e=>S.trackApiCall(e),ee=()=>S.getTrackedApiCalls(),et=()=>S.getCurrentPageName(),ea=()=>S.resetApiCallTracking(),eo=()=>S.checkHealthWithCache(),es=(e,t,a)=>S.withHealthCheck(e,t,a),en=(e,t,a)=>S.healthCheckMiddleware(e,t,a),ei=e=>S.preTrackRoutesMiddleware(e),er=e=>S.setApiBlocked(e),el=()=>S.getApiBlocked(),ec=()=>S.checkConsentMiddleware(),eu=(e,t)=>S.consentAwareMiddleware(e,t),ed=()=>S.resetHealthGate()},6517:(e,t,a)=>{a.d(t,{AV:()=>s,mI:()=>o});let o=()=>Date.now(),s=()=>new Date},6590:(e,t,a)=>{a.d(t,{k:()=>n}),a(7876);var o=a(4232);a(2202),a(3177);let s=(0,o.createContext)(void 0),n=()=>{let e=(0,o.useContext)(s);if(!e)throw Error("useCookiePreferences must be used within a CookiePreferencesProvider");return e}}}]);